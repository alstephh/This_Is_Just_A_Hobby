DNS, our IP-phonebook need no introductions

For what we have from the nmap scan we got "just" a bind server v9.4.2 with some reasearch appear to be vulnerable to a not proper zero 
length rdata (container for non exectuable and read-only data) which can lead both to denial of service or obtaining sensative info.

BIND = Berkeley Internet Name Domain composed of DNS, resolver and verification tools

Using the zero length bad handling lead the attacker to create crafted DNS records creating a recursive resolver

RECURSIVE RESOLVER = name server service which can be used for interrogate the DNS / different from stub resolvers that use library

For the DDOS parts jut go to change the TTL of the packets making the domain unreachable (also you can make a slowloris ddos really fun 
but not usefull).

There are a lot of modules or manual exploit you can use to try it (my suggestion is to use slowloris module on metasploit you just block
the service unles you don't stop sending request not a single damage after you stop)


======================================================================================================================================
REALLY INTERESTING PART BUT CAN'T EXPLOIT IT IN METASPLOITABLE SCENARIO CUZ NEED A REAL DOMAIN AND A REAL SERVER AND I DONT'T WANNA GO
IN JAIL IM TOO YOUNG
======================================================================================================================================
bind is the Internet Connection Sharing (ICS) of the victim which is vulnerable to Cache Poisoning

 CP is a attack which consist in load resources controlled (partially/totally) from the attacker is based on 3 steps

1] discover unkeyed input, the cache will ignor this particular input
2] find a method to abuse it
3] get the response cached

For [1] is a good thing to look at special http headers (curl -l -I) or send a request with bad header and try to access it if in both 
actions server respond with 400 is vulnerable (this method is unstable not factual) 

Btw, the specific CVE is 2008-4194 and 2008-1447 and will perform a domain hijack, yes we actually are stealing the web-server
(this can have financly but also in terms of readership), this type of attack can put in real danger the domain, you can make phishing and
replace website with a one that store credentials and even spread malware (or whatever)

The real breaking point of BIND 9.4.2 is the insufficent randomness of DN transactions ID making them easy to guess (birthday attack)
indeed the avg time is 100-300 seconds this is where the poisoning start and going to replace the real name server with the spoofed one
using the query.
So if 1 of our ID get a response that's our way to get in


using bailiwicked_domain will do this for us and also display all the output of what explained above (if we are in a real world scenario)
